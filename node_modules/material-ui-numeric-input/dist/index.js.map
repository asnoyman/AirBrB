{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["import type { TextFieldProps } from '@mui/material';\nimport { TextField } from '@mui/material';\nimport React, { useMemo } from 'react';\n\nexport interface HTMLNumericElement\n  extends Omit<HTMLInputElement, 'value' | 'name'> {\n  value: number | null | '';\n  name?: string;\n}\n\nexport type NumericInputProps = Omit<TextFieldProps, 'onChange'> & {\n  value?: number | string;\n  onChange?(e: React.ChangeEvent<HTMLNumericElement>): void;\n\n  precision: number;\n  thousandChar: string;\n  decimalChar: string;\n};\n\nfunction verifyNumber(string: string) {\n  const numericRepresentation = string.replace(/[,.]/g, '');\n\n  return {\n    isNumber: !isNaN(Number(numericRepresentation)),\n    numberFomart: !isNaN(Number(numericRepresentation))\n      ? Number(numericRepresentation)\n      : null\n  };\n}\n\nfunction NumericInput(props: NumericInputProps) {\n  const { value, precision, thousandChar, decimalChar, ...inputProps } = props;\n  const defaultValue = value === null ? NaN : Number(value);\n\n  const formatter = useMemo(\n    () =>\n      new Intl.NumberFormat('pt-BR', {\n        minimumFractionDigits: precision,\n        maximumFractionDigits: precision\n      }),\n\n    [thousandChar, decimalChar]\n  );\n\n  if (!decimalChar) {\n    throw new Error('Decimal char should not be an empty string!');\n  }\n  if (!thousandChar) {\n    throw new Error('Thousand char should not be an empty string!');\n  }\n\n  function format(number: number) {\n    const result = formatter\n      .format(number)\n      .replace(',', decimalChar)\n      .replaceAll('.', thousandChar);\n\n    return result;\n  }\n\n  function handleKeyDown(e: React.KeyboardEvent<HTMLInputElement>): void {\n    if (e.key === ' ') e.preventDefault();\n\n    if (\n      e.ctrlKey ||\n      e.shiftKey ||\n      e.key === 'Backspace' ||\n      e.key === 'Enter' ||\n      e.key === 'Tab'\n    )\n      return;\n    if (!verifyNumber(e.key).isNumber) e.preventDefault();\n  }\n\n  function handleChange(e: React.ChangeEvent<HTMLInputElement>): void {\n    const newEvent: React.ChangeEvent<HTMLNumericElement> = {\n      ...e,\n      currentTarget: {\n        ...e.currentTarget,\n        name: props.name,\n        value: 0\n      },\n      target: {\n        ...e.target,\n        name: props.name,\n        value: 0\n      }\n    };\n    let numericRepresentation = e.target.value;\n\n    numericRepresentation = numericRepresentation.replaceAll(thousandChar, '');\n    numericRepresentation = numericRepresentation.replace(decimalChar, '');\n\n    if (numericRepresentation === '') {\n      e.target.value = '';\n      newEvent.target.value = null;\n      newEvent.currentTarget.value = null;\n      return props.onChange && props.onChange(newEvent);\n    }\n\n    const { isNumber, numberFomart } = verifyNumber(numericRepresentation);\n    if (isNumber && numberFomart) {\n      const withPrecision = numberFomart / 10 ** precision;\n\n      const formattedNumber = format(withPrecision);\n\n      newEvent.target.value = withPrecision;\n      newEvent.currentTarget.value = withPrecision;\n\n      e.target.value = formattedNumber;\n\n      props.onChange && props.onChange(newEvent);\n    }\n  }\n\n  const hasValue = value !== undefined;\n  let inputDefaultValue;\n  let inputValue;\n\n  if (hasValue) {\n    if (isNaN(defaultValue) || value === '') {\n      inputValue = null;\n    } else {\n      inputValue = format(defaultValue);\n    }\n  }\n\n  if (!hasValue && !isNaN(defaultValue)) {\n    inputDefaultValue = format(defaultValue);\n  }\n\n  return (\n    <TextField\n      defaultValue={inputDefaultValue}\n      {...inputProps}\n      onKeyDown={handleKeyDown}\n      onChange={handleChange}\n      value={inputValue}\n    />\n  );\n}\n\nexport default NumericInput;\n"],"names":["verifyNumber","string","numericRepresentation","replace","isNumber","isNaN","Number","numberFomart","NumericInput","props","value","precision","thousandChar","decimalChar","inputProps","defaultValue","NaN","formatter","useMemo","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","Error","format","number","result","replaceAll","handleKeyDown","e","key","preventDefault","ctrlKey","shiftKey","handleChange","newEvent","currentTarget","name","target","onChange","withPrecision","formattedNumber","hasValue","undefined","inputDefaultValue","inputValue","React","TextField","onKeyDown"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmBA,SAASA,YAAT,CAAsBC,MAAtB;AACE,MAAMC,qBAAqB,GAAGD,MAAM,CAACE,OAAP,CAAe,OAAf,EAAwB,EAAxB,CAA9B;AAEA,SAAO;AACLC,IAAAA,QAAQ,EAAE,CAACC,KAAK,CAACC,MAAM,CAACJ,qBAAD,CAAP,CADX;AAELK,IAAAA,YAAY,EAAE,CAACF,KAAK,CAACC,MAAM,CAACJ,qBAAD,CAAP,CAAN,GACVI,MAAM,CAACJ,qBAAD,CADI,GAEV;AAJC,GAAP;AAMD;;AAED,SAASM,YAAT,CAAsBC,KAAtB;AACE,MAAQC,KAAR,GAAuED,KAAvE,CAAQC,KAAR;AAAA,MAAeC,SAAf,GAAuEF,KAAvE,CAAeE,SAAf;AAAA,MAA0BC,YAA1B,GAAuEH,KAAvE,CAA0BG,YAA1B;AAAA,MAAwCC,WAAxC,GAAuEJ,KAAvE,CAAwCI,WAAxC;AAAA,MAAwDC,UAAxD,iCAAuEL,KAAvE;;AACA,MAAMM,YAAY,GAAGL,KAAK,KAAK,IAAV,GAAiBM,GAAjB,GAAuBV,MAAM,CAACI,KAAD,CAAlD;AAEA,MAAMO,SAAS,GAAGC,aAAO,CACvB;AAAA,WACE,IAAIC,IAAI,CAACC,YAAT,CAAsB,OAAtB,EAA+B;AAC7BC,MAAAA,qBAAqB,EAAEV,SADM;AAE7BW,MAAAA,qBAAqB,EAAEX;AAFM,KAA/B,CADF;AAAA,GADuB,EAOvB,CAACC,YAAD,EAAeC,WAAf,CAPuB,CAAzB;;AAUA,MAAI,CAACA,WAAL,EAAkB;AAChB,UAAM,IAAIU,KAAJ,CAAU,6CAAV,CAAN;AACD;;AACD,MAAI,CAACX,YAAL,EAAmB;AACjB,UAAM,IAAIW,KAAJ,CAAU,8CAAV,CAAN;AACD;;AAED,WAASC,MAAT,CAAgBC,MAAhB;AACE,QAAMC,MAAM,GAAGT,SAAS,CACrBO,MADY,CACLC,MADK,EAEZtB,OAFY,CAEJ,GAFI,EAECU,WAFD,EAGZc,UAHY,CAGD,GAHC,EAGIf,YAHJ,CAAf;AAKA,WAAOc,MAAP;AACD;;AAED,WAASE,aAAT,CAAuBC,CAAvB;AACE,QAAIA,CAAC,CAACC,GAAF,KAAU,GAAd,EAAmBD,CAAC,CAACE,cAAF;AAEnB,QACEF,CAAC,CAACG,OAAF,IACAH,CAAC,CAACI,QADF,IAEAJ,CAAC,CAACC,GAAF,KAAU,WAFV,IAGAD,CAAC,CAACC,GAAF,KAAU,OAHV,IAIAD,CAAC,CAACC,GAAF,KAAU,KALZ,EAOE;AACF,QAAI,CAAC9B,YAAY,CAAC6B,CAAC,CAACC,GAAH,CAAZ,CAAoB1B,QAAzB,EAAmCyB,CAAC,CAACE,cAAF;AACpC;;AAED,WAASG,YAAT,CAAsBL,CAAtB;AACE,QAAMM,QAAQ,gBACTN,CADS;AAEZO,MAAAA,aAAa,eACRP,CAAC,CAACO,aADM;AAEXC,QAAAA,IAAI,EAAE5B,KAAK,CAAC4B,IAFD;AAGX3B,QAAAA,KAAK,EAAE;AAHI,QAFD;AAOZ4B,MAAAA,MAAM,eACDT,CAAC,CAACS,MADD;AAEJD,QAAAA,IAAI,EAAE5B,KAAK,CAAC4B,IAFR;AAGJ3B,QAAAA,KAAK,EAAE;AAHH;AAPM,MAAd;;AAaA,QAAIR,qBAAqB,GAAG2B,CAAC,CAACS,MAAF,CAAS5B,KAArC;AAEAR,IAAAA,qBAAqB,GAAGA,qBAAqB,CAACyB,UAAtB,CAAiCf,YAAjC,EAA+C,EAA/C,CAAxB;AACAV,IAAAA,qBAAqB,GAAGA,qBAAqB,CAACC,OAAtB,CAA8BU,WAA9B,EAA2C,EAA3C,CAAxB;;AAEA,QAAIX,qBAAqB,KAAK,EAA9B,EAAkC;AAChC2B,MAAAA,CAAC,CAACS,MAAF,CAAS5B,KAAT,GAAiB,EAAjB;AACAyB,MAAAA,QAAQ,CAACG,MAAT,CAAgB5B,KAAhB,GAAwB,IAAxB;AACAyB,MAAAA,QAAQ,CAACC,aAAT,CAAuB1B,KAAvB,GAA+B,IAA/B;AACA,aAAOD,KAAK,CAAC8B,QAAN,IAAkB9B,KAAK,CAAC8B,QAAN,CAAeJ,QAAf,CAAzB;AACD;;AAED,wBAAmCnC,YAAY,CAACE,qBAAD,CAA/C;AAAA,QAAQE,QAAR,iBAAQA,QAAR;AAAA,QAAkBG,YAAlB,iBAAkBA,YAAlB;;AACA,QAAIH,QAAQ,IAAIG,YAAhB,EAA8B;AAC5B,UAAMiC,aAAa,GAAGjC,YAAY,YAAG,EAAH,EAASI,SAAT,CAAlC;AAEA,UAAM8B,eAAe,GAAGjB,MAAM,CAACgB,aAAD,CAA9B;AAEAL,MAAAA,QAAQ,CAACG,MAAT,CAAgB5B,KAAhB,GAAwB8B,aAAxB;AACAL,MAAAA,QAAQ,CAACC,aAAT,CAAuB1B,KAAvB,GAA+B8B,aAA/B;AAEAX,MAAAA,CAAC,CAACS,MAAF,CAAS5B,KAAT,GAAiB+B,eAAjB;AAEAhC,MAAAA,KAAK,CAAC8B,QAAN,IAAkB9B,KAAK,CAAC8B,QAAN,CAAeJ,QAAf,CAAlB;AACD;AACF;;AAED,MAAMO,QAAQ,GAAGhC,KAAK,KAAKiC,SAA3B;AACA,MAAIC,iBAAJ;AACA,MAAIC,UAAJ;;AAEA,MAAIH,QAAJ,EAAc;AACZ,QAAIrC,KAAK,CAACU,YAAD,CAAL,IAAuBL,KAAK,KAAK,EAArC,EAAyC;AACvCmC,MAAAA,UAAU,GAAG,IAAb;AACD,KAFD,MAEO;AACLA,MAAAA,UAAU,GAAGrB,MAAM,CAACT,YAAD,CAAnB;AACD;AACF;;AAED,MAAI,CAAC2B,QAAD,IAAa,CAACrC,KAAK,CAACU,YAAD,CAAvB,EAAuC;AACrC6B,IAAAA,iBAAiB,GAAGpB,MAAM,CAACT,YAAD,CAA1B;AACD;;AAED,SACE+B,4BAAA,CAACC,kBAAD;AACEhC,IAAAA,YAAY,EAAE6B;KACV9B;AACJkC,IAAAA,SAAS,EAAEpB;AACXW,IAAAA,QAAQ,EAAEL;AACVxB,IAAAA,KAAK,EAAEmC;IALT,CADF;AASD;;;;"}